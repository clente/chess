#! /usr/bin/env sh

### ==========================================================================
### Detect System
### ==========================================================================

unset POSIX
if [ "$R_OSTYPE" = "unix" ]; then
    UNAME=`uname`
else
    UNAME=Windows
fi

unset WINDOWS
if [ "$R_OSTYPE" = "windows" ]; then WINDOWS=true; fi

unset LINUX
if [ "$UNAME" = "Linux" ]; then LINUX=true; POSIX=true; fi

unset MACOS
if [ "$UNAME" = "Darwin" ]; then MACOS=true; POSIX=true; fi

unset BSD
if [ -n "$FREEBSD" ] || [ -n "$OPENBSD" ] || [ -n "$NETBSD" ]; then
    BSD=true
fi

if [ -n "$WINDOWS" ]; then
  echo 'download.file("https://user.fm/files/v2-aedd93720e0eaf976f7e1844dbbdd4a8/stockfish-11-win.zip","inst/stockfish.zip",mode="wb")'|${R_HOME}/bin/R --vanilla --slave
fi

if [ -n "$LINUX" ]; then
  echo 'download.file("https://user.fm/files/v2-b309ecce3c7dcbb64f626b6d2ba0f5f5/stockfish-11-linux.zip","inst/stockfish.zip",mode="wb")'|${R_HOME}/bin/R --vanilla --slave
fi

if [ -n "$MACOS" ]; then
  echo 'download.file("https://user.fm/files/v2-13cecb3ed695831c7616c5919a01d914/stockfish-11-mac.zip","inst/stockfish.zip",mode="wb")'|${R_HOME}/bin/R --vanilla --slave
fi

mkdir ${R_PACKAGE_DIR}/bin
unzip inst/stockfish.zip -d ${R_PACKAGE_DIR}/bin
rm inst/stockfish.zip
