#! /usr/bin/env sh

### ==========================================================================
### Detect System
### ==========================================================================

unset POSIX
if [ "$R_OSTYPE" = "unix" ]; then
    UNAME=`uname`
else
    UNAME=Windows
fi

unset WINDOWS
if [ "$R_OSTYPE" = "windows" ]; then WINDOWS=true; fi

unset LINUX
if [ "$UNAME" = "Linux" ]; then LINUX=true; POSIX=true; fi

unset MACOS
if [ "$UNAME" = "Darwin" ]; then MACOS=true; POSIX=true; fi

unset BSD
if [ -n "$FREEBSD" ] || [ -n "$OPENBSD" ] || [ -n "$NETBSD" ]; then
    BSD=true
fi

if [ -n "$WINDOWS" ]; then
  echo 'download.file("https://user.fm/files/v2-4023e6a8aae73b78ba5901ae6153fd99/stockfish_win.zip","inst/stockfish.zip",mode="wb")'|${R_HOME}/bin/R --vanilla --slave
fi

if [ -n "$LINUX" ]; then
  echo 'download.file("https://user.fm/files/v2-ce56b921399caa3f33abb51ba02332a3/stockfish_linux.zip","inst/stockfish.zip",mode="wb")'|${R_HOME}/bin/R --vanilla --slave
fi

if [ -n "$MACOS" ]; then
  echo 'download.file("https://user.fm/files/v2-0f0256deae76589b179e10ff3968ac9e/stockfish_macos.zip","inst/stockfish.zip",mode="wb")'|${R_HOME}/bin/R --vanilla --slave
fi

mkdir ${R_PACKAGE_DIR}/bin
unzip inst/stockfish.zip -d ${R_PACKAGE_DIR}/bin
rm inst/stockfish.zip
