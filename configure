#! /usr/bin/env sh

### ==========================================================================
### Detect System
### ==========================================================================

unset POSIX
if [ "$R_OSTYPE" = "unix" ]; then
    UNAME=`uname`
else
    UNAME=Windows
fi

unset WINDOWS
if [ "$R_OSTYPE" = "windows" ]; then WINDOWS=true; fi

unset LINUX
if [ "$UNAME" = "Linux" ]; then LINUX=true; POSIX=true; fi

unset MACOS
if [ "$UNAME" = "Darwin" ]; then MACOS=true; POSIX=true; fi

unset BSD
if [ -n "$FREEBSD" ] || [ -n "$OPENBSD" ] || [ -n "$NETBSD" ]; then
    BSD=true
fi

if [ -n "$WINDOWS" ]; then
  echo 'download.file("https://stockfishchess.org/files/stockfish_12_win_x64_bmi2.zip","inst/stockfish.zip",mode="wb")'|${R_HOME}/bin/R --vanilla --slave
fi

if [ -z "$WINDOWS" ]; then
  echo 'download.file("https://stockfishchess.org/files/stockfish_12_linux_x64_bmi2.zip","inst/stockfish.zip",mode="wb")'|${R_HOME}/bin/R --vanilla --slave
fi

mkdir ${R_PACKAGE_DIR}/bin
unzip inst/stockfish.zip -d ${R_PACKAGE_DIR}/bin
rm inst/stockfish.zip
